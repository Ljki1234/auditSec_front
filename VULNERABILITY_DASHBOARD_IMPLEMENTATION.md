# Implémentation du Tableau de Bord des Vulnérabilités

## Vue d'ensemble

Ce document décrit l'implémentation du tableau de bord des vulnérabilités qui remplace les données statiques par des données dynamiques provenant de votre API backend Spring Boot.

## Architecture

### 1. Service de Statistiques (`VulnerabilityStatisticsService`)

Le service `VulnerabilityStatisticsService` est responsable de la communication avec votre API backend :

- **Endpoint principal** : `http://localhost:8080/api/vulnerability-statistics`
- **Méthodes disponibles** :
  - `getDashboardStatistics()` : Récupère les données pour le tableau de bord
  - `getComprehensiveStatistics()` : Récupère toutes les statistiques
  - `getWebsiteStatistics(websiteId)` : Statistiques pour un site spécifique
  - `getStatisticsByType()` : Statistiques par type de vulnérabilité
  - `getStatisticsBySeverity()` : Statistiques par niveau de sévérité

### 2. Interface des Données (`DashboardData`)

```typescript
export interface DashboardData {
  total: number;           // Total des vulnérabilités
  xss: number;            // Nombre de vulnérabilités XSS
  sqlInjection: number;   // Nombre d'injections SQL
  csrf: number;           // Nombre de vulnérabilités CSRF
  headers: number;        // Nombre de vulnérabilités de headers
  autres: number;         // Autres types de vulnérabilités
  globalRiskScore: number; // Score de risque global
  criticalCount: number;  // Nombre de vulnérabilités critiques
  highCount: number;      // Nombre de vulnérabilités élevées
  mediumCount: number;    // Nombre de vulnérabilités moyennes
  lowCount: number;       // Nombre de vulnérabilités faibles
  sitesSurveilles?: number; // Nombre de sites surveillés
  auditsRealises?: number;  // Nombre d'audits réalisés
}
```

### 3. Composant du Tableau de Bord

Le composant `TableauDeBordComponent` a été modifié pour :

- **Charger les données dynamiquement** depuis l'API au lieu d'utiliser des données statiques
- **Afficher les vraies statistiques** de vulnérabilités de votre base de données
- **Mettre à jour les graphiques** avec les données réelles
- **Gérer les états de chargement** et les erreurs

## Fonctionnalités Implémentées

### Cartes de Statistiques
- **Sites Surveillés** : Nombre de sites web surveillés
- **Audits Réalisés** : Nombre total d'audits effectués
- **Vulnérabilités** : Total des vulnérabilités détectées
- **Alertes Critiques** : Nombre de vulnérabilités critiques

### Section des Types de Vulnérabilités
- **Affichage détaillé** de chaque type de vulnérabilité
- **Compteurs en temps réel** pour chaque catégorie
- **Design moderne** avec badges colorés et animations

### Graphiques Dynamiques
- **Graphique circulaire** des types de vulnérabilités
- **Mise à jour automatique** des données
- **Couleurs personnalisées** pour chaque type

## Intégration avec l'API Backend

### Authentification
Le service utilise automatiquement le token d'authentification stocké dans le service `AuthService` :
```typescript
private getAuthHeaders(): HttpHeaders {
  const token = this.authService.getCurrentToken();
  return new HttpHeaders({
    'Content-Type': 'application/json',
    'Authorization': `Bearer ${token}`
  });
}
```

### Gestion des Erreurs
- **Gestion des erreurs réseau** avec messages utilisateur
- **Fallback sur les données par défaut** en cas d'échec
- **Logs détaillés** pour le débogage

## Utilisation

### 1. Accès au Tableau de Bord
Naviguez vers `/tableau-de-bord` dans votre application Angular.

### 2. Chargement des Données
Les données se chargent automatiquement au démarrage du composant.

### 3. Mise à Jour
Les données se mettent à jour à chaque visite de la page.

## Configuration

### URL de l'API
L'URL de l'API est configurée dans le service :
```typescript
private readonly API_BASE_URL = 'http://localhost:8080/api/vulnerability-statistics';
```

### CORS
Assurez-vous que votre backend Spring Boot autorise les requêtes depuis `http://localhost:4200`.

## Tests

### Test de Compilation
```bash
npm run build
```

### Test en Développement
```bash
npm start
```

## Dépannage

### Problèmes Courants

1. **Erreur CORS** : Vérifiez la configuration CORS dans votre backend
2. **Erreur 401** : Vérifiez que l'utilisateur est authentifié
3. **Données vides** : Vérifiez que votre API retourne les bonnes données

### Logs de Débogage
Les erreurs sont loggées dans la console du navigateur avec des messages détaillés.

## Évolutions Futures

- **Rafraîchissement automatique** des données
- **Filtres par période** (jour, semaine, mois)
- **Export des données** en PDF/CSV
- **Notifications en temps réel** des nouvelles vulnérabilités
- **Comparaison temporelle** des statistiques

## Support

Pour toute question ou problème, consultez :
- Les logs de la console du navigateur
- La documentation de l'API backend
- Les interfaces TypeScript pour la structure des données
